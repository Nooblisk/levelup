<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" type="text/css" href="css/semantic.min.css">

    <style type="text/css">
        body {
            background-color: #ffffff;
            background-size: cover;
        }
        .layer {
            overflow-x: auto; /* Добавляем полосу прокрутки */
            width: auto; /* Ширина блока */
            height: auto; /* Высота блока */
            padding: 5px; /* Поля вокруг текста */
            border: solid 1px white; /* Параметры рамки */
            white-space: nowrap; /* Запрещаем перенос строк */
        }

    </style>
</head>
<body>
<h1></h1>
<div class="ui container">
    <div class="ui three column grid">
        <div class="row">
            <div class="left floated three wide column">
                <div class="ui red huge left label">
                    Мой уровень
                </div>
            </div>
            <div class="right floated twelve wide column">
                <table class="ui fixed right celled table">
                    <thead>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="center aligned">1</td>
                        <td class="disabled center aligned">2</td>
                        <td class="disabled center aligned">3</td>
                        <td class="disabled center aligned">4</td>
                        <td class="disabled center aligned">5</td>
                        <td class="disabled center aligned">6</td>
                        <td class="disabled center aligned">7</td>
                        <td class="disabled center aligned">8</td>
                        <td class="disabled center aligned">9</td>
                        <td class="disabled center aligned">10</td>
                        <td class="disabled center aligned">11</td>
                        <td class="disabled center aligned">12</td>
                        <td class="disabled center aligned">13</td>
                        <td class="disabled center aligned">14</td>
                        <td class="disabled center aligned">15</td>
                        <td class="disabled center aligned">16</td>
                        <td class="disabled center aligned">17</td>
                        <td class="disabled center aligned">18</td>
                        <td class="disabled center aligned">19</td>
                        <td class="disabled center aligned">20</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="right floated one wide column">
                <button id="buttonSignIn" class="ui button" type="submit">Sign In</button>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="left floated column">
    <form id="loginForm" class="ui form" style="display: none">
        <div id="loginField" class="required field">
            <label>Login</label>
            <input id= "loginInput" type="text" name="first-name" placeholder="test">
        </div>
        <div id="passwordField" class="required field">
            <label>Password</label>
            <input id="passwordInput" type="text" name="last-name" placeholder="test">
        </div>
    </form>
        </div>
    </div>
    <div class="row">
        <div class="left floated two wide column">
              <button id="buttonLogin" class="ui button" type="submit" style="display: none">Login</button>
    <!--<button id="buttonGet" class="ui button" type="submit">Get</button>-->
        </div>
        <div class="two wide column">
            <button id="buttonUpdateFeatures" class="ui button" type="submit">Update Features</button>
        </div>
    </div>




   <!-- <div class="ui equal width grid">
        <div class="ui row">
            <div class="column">
                <div id="labelSkill0" class="ui image green huge label">
                    <img id="imgSkill0" src="http://lorempixel.com/640/480/?3457">
                    Скилл
                </div>
            </div>
            <div class="column">
                <div id="labelSkill1" class="ui green image huge label">
                    <img id="imgSkill1" src="http://lorempixel.com/640/480/?3457">
                    Скилл
                </div>
            </div>
            <div class="column">
                <div id="labelSkill2" class="ui image green huge label">
                    <img id="imgSkill2" src="http://lorempixel.com/640/480/?3457">
                    Скилл
                </div>
            </div>
            <div class="column">
                <div id="labelSkill3" class="ui image green huge label">
                    <img id="imgSkill3" src="http://lorempixel.com/640/480/?3457">
                    Скилл
                </div>
            </div>
            <div class="column">
                <div id="labelSkill4" class="ui image green huge label">
                    <img id="imgSkill4" src="http://lorempixel.com/640/480/?3457">
                    Скилл
                </div>
            </div>
            <div class="column">
                <div id="labelSkill5" class="ui image green huge label">
                    <img id="imgSkill5" src="http://lorempixel.com/640/480/?3457">
                    Скилл
                </div>
            </div>
        </div>
        </div>-->
    <!--<div class="layer">
    <div class="ui massive horizontal list">
        <div id="itemSkill0" class="item">
            <img id="avatarSkill0" class="ui avatar image" src="http://lorempixel.com/640/480/?3457">
            <div id="contentSkill0" class="content">
                <div id="headerSkill0" class="header">Скилл</div>
                уровень 1
            </div>
        </div>
        <div id="itemSkill1" class="item" data-title="Using click events" data-content="Clicked popups will close if you click away, but not if you click inside the popup">
            <img id="avatarSkill1" class="ui avatar image" src="http://lorempixel.com/640/480/?3457">
            <div id="contentSkill1" class="content">
                <div id="headerSkill1" class="header">Скилл</div>
                уровень 1
            </div>
        </div>
        <div id="itemSkill2" class="item">
            <img id="avatarSkill2" class="ui avatar image" src="http://lorempixel.com/640/480/?3457">
            <div id="contentSkill2" class="content">
                <div id="headerSkill2" class="header">Скилл</div>
                уровень 1
            </div>
        </div>
        <div id="itemSkill3" class="item">
            <img id="avatarSkill3" class="ui avatar image" src="http://lorempixel.com/640/480/?3457">
            <div id="contentSkill3" class="content">
                <div id="headerSkill3" class="header">Скилл</div>
                уровень 1
            </div>
        </div>
        <div id="itemSkill4" class="item">
            <img id="avatarSkill4" class="ui avatar image" src="http://lorempixel.com/640/480/?3457">
            <div id="contentSkill4" class="content">
                <div id="headerSkill4" class="header">Скилл</div>
                уровень 1
            </div>
        </div>
        <div id="itemSkill5" class="item">
            <img id="avatarSkill5" class="ui avatar image" src="http://lorempixel.com/640/480/?3457">
            <div id="contentSkill5" class="content">
                <div id="headerSkill5" class="header">Скилл</div>
                уровень 1
            </div>
        </div>

    </div>
    </div>-->



    <div class="layer">
    <div id="templateList" class="ui massive horizontal list">
        <script id="template" type="text/x-handlebars-template">
              <div id="itemFeature{{id}}" class="item">
                    <img class="ui avatar image" src={{image_url}}>
                    <div class="content">
                         <div class="header">{{title}}</div>
                         уровень {{level}}
                    </div>
              </div>
       </script>
    </div>
</div>






    <h4 id="headerText" class="ui header"></h4>
    <h4 id="headerText2" class="ui header"></h4>
    <h4 id="headerText3" class="ui header"></h4>
</div>


<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script src="js/semantic.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
<script>










    $( "#buttonSignIn" ).click(function(){
        //alert("asasdasdasd");
        $( "#loginForm" ).fadeIn();
        $( "#buttonLogin").fadeIn();
    });

var username1, password1;
    $( "#loginInput" )
            .keyup(function(){
                username1 = $( this ).val();
            }).keyup();

    $( "#passwordInput" )
            .keyup(function(){
                password1 = $( this ).val();
            }).keyup();





    /*$( "#buttonHide" ).click(function(){
        //alert("asasdasdasd");
        $( "#loginForm" ).fadeOut();
    });*/
</script>
<script>
    var Obj, Obj2;
    var Update = 0;
    $( "#buttonLogin").click(function(){
        $.post("/app_dev.php/api/oauth/v2/token", {grant_type: "password", client_id: "1_web", client_secret: "web", username: username1, password: password1}).success(function(a){
            Obj=a;
            $("#headerText").text(JSON.stringify(Obj));
            //$("#headerText2").text(username1 + " " + password1);
            $( "#loginForm" ).fadeOut();
            $( "#buttonLogin").fadeOut();

        });
    });



   /* $( "#buttonGet").click(function() {
        $.ajax({
            method: "GET",
            url: "/app_dev.php/api/features",
            headers: { Authorization: 'Bearer ' + Obj.access_token}
        }).success(function(z) {
            Obj2 = z;
            $("#headerText3").text(JSON.stringify(Obj2));
            //$("#headerText4").text(Obj2.features[0].image_url);


        });
    });*/


    $( "#buttonUpdateFeatures").click(function() {
        $.ajax({
            method: "GET",
            url: "/app_dev.php/api/features",
            headers: {Authorization: 'Bearer ' + Obj.access_token}
        }).success(function (z) {
            Update+=1;
            Obj2 = z;
            $("#headerText3").text(JSON.stringify(Obj2));

            //$( "#templateList" ).empty();

            var template = Handlebars.compile( $('#template').html() );
            for (var i = 1; i <= Obj2.features.length; i++) {

                /*$("#imgSkill" + i).attr("src", Obj2.features[i].image_url);
                $("#avatarSkill" + i).attr("src", Obj2.features[i].image_url);
                $("#labelSkill" + i).contents().last().replaceWith(Obj2.features[i].title + " lvl " + Obj2.features[i].level);
                $("#headerSkill" + i).text(Obj2.features[i].title);
                $("#contentSkill" + i).contents().last().replaceWith(" уровень " + Obj2.features[i].level);
                $("#itemSkill" + i).attr({
                    "data-title": Obj2.features[i].title,
                    "data-content": Obj2.features[i].description
                });*/

                if (Update == 1){
                    $('#templateList').append( template(Obj2.features[i-1]) );
                    $("#itemFeature" + i).attr({
                        "data-title": Obj2.features[i-1].title,
                        "data-content": Obj2.features[i-1].description
                    });
                }
                else {
                    $("#itemFeature" + i).replaceWith(template(Obj2.features[i-1]));
                    $("#itemFeature" + i).attr({
                        "data-title": Obj2.features[i-1].title,
                        "data-content": Obj2.features[i-1].description
                    });
                }
                $("#itemFeature" + i)
                        .popup({
                            on: 'click'
                        })
                ;
            }

        });
    });

//    $('.item')
//            .popup({
//                on: 'click'
//            })
//    ;





/*function Ucfirst(str){
    if (!str) return str;
    return str[0].toUpperCase() + str.substring(1);
}*/


</script>


</body>
</html>